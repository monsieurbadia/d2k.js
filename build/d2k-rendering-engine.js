(function () {function U(a){return a&&a.__esModule?{d:a.default}:{d:a}}var q={};function aa(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})),t.push.apply(t,n)}return t}function ia(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?aa(Object(t),!0).forEach(function(e){var $x3DH$$interop$default=U(Z);$x3DH$$interop$default.d(r,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):aa(Object(t)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))})}return r}var Z={};function ha(e,r,$){return r in e?Object.defineProperty(e,r,{value:$,enumerable:!0,configurable:!0,writable:!0}):e[r]=$,e}Z=ha;var F={extend:function(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];return[].concat(e).reduce(function(r,e){return e(r)},Object.assign({},ia({},this)))}};function W(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var $=Object.getOwnPropertySymbols(e);t&&($=$.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,$)}return r}function fa(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?W(Object(r),!0).forEach(function(t){var $x3DH$$interop$default=U(Z);$x3DH$$interop$default.d(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var X="undefined"!=typeof Float32Array?Float32Array:Array;var G=1e-6;function ma(){var $=new X(16);return X!=Float32Array&&($[1]=0,$[2]=0,$[3]=0,$[4]=0,$[6]=0,$[7]=0,$[8]=0,$[9]=0,$[11]=0,$[12]=0,$[13]=0,$[14]=0),$[0]=1,$[5]=1,$[10]=1,$[15]=1,$}function _($){return $[0]=1,$[1]=0,$[2]=0,$[3]=0,$[4]=0,$[5]=1,$[6]=0,$[7]=0,$[8]=0,$[9]=0,$[10]=1,$[11]=0,$[12]=0,$[13]=0,$[14]=0,$[15]=1,$}function ra($,t){var r=t[0],e=t[1],o=t[2],p=t[3],h=t[4],A=t[5],n=t[6],x=t[7],D=t[8],a=t[9],s=t[10],i=t[11],u=t[12],c=t[13],l=t[14],y=t[15],v=r*A-e*h,f=r*n-o*h,E=r*x-p*h,P=e*n-o*A,M=e*x-p*A,R=o*x-p*n,Y=D*c-a*u,I=D*l-s*u,L=D*y-i*u,N=a*l-s*c,O=a*y-i*c,S=s*y-i*l,d=v*S-f*O+E*N+P*L-M*I+R*Y;return d?(d=1/d,$[0]=(A*S-n*O+x*N)*d,$[1]=(o*O-e*S-p*N)*d,$[2]=(c*R-l*M+y*P)*d,$[3]=(s*M-a*R-i*P)*d,$[4]=(n*L-h*S-x*I)*d,$[5]=(r*S-o*L+p*I)*d,$[6]=(l*E-u*R-y*f)*d,$[7]=(D*R-s*E+i*f)*d,$[8]=(h*O-A*L+x*Y)*d,$[9]=(e*L-r*O-p*Y)*d,$[10]=(u*M-c*E+y*v)*d,$[11]=(a*E-D*M-i*v)*d,$[12]=(A*I-h*N-n*Y)*d,$[13]=(r*N-e*I+o*Y)*d,$[14]=(c*f-u*P-l*v)*d,$[15]=(D*P-a*f+s*v)*d,$):null}function ua($,t,r,e){var o,p,h,A,n,x,D,a,s,i,u=t[0],c=t[1],l=t[2],y=e[0],v=e[1],f=e[2],E=r[0],P=r[1],M=r[2];return Math.abs(u-E)<G&&Math.abs(c-P)<G&&Math.abs(l-M)<G?_($):(D=u-E,a=c-P,s=l-M,o=v*(s*=i=1/Math.hypot(D,a,s))-f*(a*=i),p=f*(D*=i)-y*s,h=y*a-v*D,(i=Math.hypot(o,p,h))?(o*=i=1/i,p*=i,h*=i):(o=0,p=0,h=0),A=a*h-s*p,n=s*o-D*h,x=D*p-a*o,(i=Math.hypot(A,n,x))?(A*=i=1/i,n*=i,x*=i):(A=0,n=0,x=0),$[0]=o,$[1]=A,$[2]=D,$[3]=0,$[4]=p,$[5]=n,$[6]=a,$[7]=0,$[8]=h,$[9]=x,$[10]=s,$[11]=0,$[12]=-(o*u+p*c+h*l),$[13]=-(A*u+n*c+x*l),$[14]=-(D*u+a*c+s*l),$[15]=1,$)}function Qa($,t,r,e,o,p,h){var A=1/(t-r),n=1/(e-o),x=1/(p-h);return $[0]=-2*A,$[1]=0,$[2]=0,$[3]=0,$[4]=0,$[5]=-2*n,$[6]=0,$[7]=0,$[8]=0,$[9]=0,$[10]=2*x,$[11]=0,$[12]=(t+r)*A,$[13]=(o+e)*n,$[14]=(h+p)*x,$[15]=1,$}function ca($,t,r,e,o){var p,h=1/Math.tan(t/2);return $[0]=h/r,$[1]=0,$[2]=0,$[3]=0,$[4]=0,$[5]=h,$[6]=0,$[7]=0,$[8]=0,$[9]=0,$[11]=-1,$[12]=0,$[13]=0,$[15]=0,null!=o&&o!==1/0?(p=1/(e-o),$[10]=(o+e)*p,$[14]=2*o*e*p):($[10]=-1,$[14]=-2*e),$}function da($,t,r,e){var o,p,h,A,n,x,D,a,s,i,u,c,l,y,v,f,E,P,M,R,Y,I,L,N,O=e[0],S=e[1],d=e[2],T=Math.hypot(O,S,d);return T<G?null:(O*=T=1/T,S*=T,d*=T,o=Math.sin(r),h=1-(p=Math.cos(r)),A=t[0],n=t[1],x=t[2],D=t[3],a=t[4],s=t[5],i=t[6],u=t[7],c=t[8],l=t[9],y=t[10],v=t[11],f=O*O*h+p,E=S*O*h+d*o,P=d*O*h-S*o,M=O*S*h-d*o,R=S*S*h+p,Y=d*S*h+O*o,I=O*d*h+S*o,L=S*d*h-O*o,N=d*d*h+p,$[0]=A*f+a*E+c*P,$[1]=n*f+s*E+l*P,$[2]=x*f+i*E+y*P,$[3]=D*f+u*E+v*P,$[4]=A*M+a*R+c*Y,$[5]=n*M+s*R+l*Y,$[6]=x*M+i*R+y*Y,$[7]=D*M+u*R+v*Y,$[8]=A*I+a*L+c*N,$[9]=n*I+s*L+l*N,$[10]=x*I+i*L+y*N,$[11]=D*I+u*L+v*N,t!==$&&($[12]=t[12],$[13]=t[13],$[14]=t[14],$[15]=t[15]),$)}function ea($,t,r){var e=r[0],o=r[1],p=r[2];return $[0]=t[0]*e,$[1]=t[1]*e,$[2]=t[2]*e,$[3]=t[3]*e,$[4]=t[4]*o,$[5]=t[5]*o,$[6]=t[6]*o,$[7]=t[7]*o,$[8]=t[8]*p,$[9]=t[9]*p,$[10]=t[10]*p,$[11]=t[11]*p,$[12]=t[12],$[13]=t[13],$[14]=t[14],$[15]=t[15],$}function Q($,t,r,e,o,p,h,A,n,x,D,a,s,i,u,c,l){return $[0]=t,$[1]=r,$[2]=e,$[3]=o,$[4]=p,$[5]=h,$[6]=A,$[7]=n,$[8]=x,$[9]=D,$[10]=a,$[11]=s,$[12]=i,$[13]=u,$[14]=c,$[15]=l,$}function ga($,t,r){var e,o,p,h,A,n,x,D,a,s,i,u,c=r[0],l=r[1],y=r[2];return t===$?($[12]=t[0]*c+t[4]*l+t[8]*y+t[12],$[13]=t[1]*c+t[5]*l+t[9]*y+t[13],$[14]=t[2]*c+t[6]*l+t[10]*y+t[14],$[15]=t[3]*c+t[7]*l+t[11]*y+t[15]):(e=t[0],o=t[1],p=t[2],h=t[3],A=t[4],n=t[5],x=t[6],D=t[7],a=t[8],s=t[9],i=t[10],u=t[11],$[0]=e,$[1]=o,$[2]=p,$[3]=h,$[4]=A,$[5]=n,$[6]=x,$[7]=D,$[8]=a,$[9]=s,$[10]=i,$[11]=u,$[12]=e*c+A*l+a*y+t[12],$[13]=o*c+n*l+s*y+t[13],$[14]=p*c+x*l+i*y+t[14],$[15]=h*c+D*l+u*y+t[15]),$}var K,B={};!function(){function e(e){return e&&e.__esModule?{d:e.default}:{d:e}}var r={};function t(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function n(r){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?t(Object(i),!0).forEach(function(t){e(o).d(r,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):t(Object(i)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(i,e))})}return r}var o={};o=function(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e};var i=function(e){throw new Error("".concat(e))},u={set required(e){i(e)},get required(){i("required parameter")},set warning(e){!function(e){console.warn("".concat(e))}(e)},log:function(e){return window.console&&window.console.log&&console.log(e)}},c=function(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()},a=function(e){return Array.isArray(e)},f=function(e){return a(e)?e.length>0:Object.keys(n({},e)).length>0},s=function(e){return a(e)?0===e.length:!Object.keys(n({},e)).length},p={array:a,bool:function(e){return"boolean"===c(e)},contains:f,date:function(e){return"date"===c(e)},empty:s,error:function(e){return"error"===c(e)},exist:function(e){return u.warning="\"exist\" method has been deprecated use \"contains\" instead.",Object.keys(n({},e)).length>0},include:function(e,r){return!s(e)&&!s(r)&&(a(e)?function(e){var r=e.query;return e.payload.includes(r)}({payload:e,query:r}):function(e){var r=e.payload,t=e.query;return f(r)&&void 0!==Object.keys(r).find(function(e){return e===t})}({payload:e,query:r}))},method:function(e){return"function"===c(e)},number:function(e){return Number.isFinite(e)},regex:function(e){return"regexp"===c(e)},string:function(e){return"string"===c(e)},trueObject:function(e){return"object"===c(e)},unknown:function(e){return null==e}},l={keys2Array:function(e){return p.trueObject(e)?Object.values(e):u.warning="argument is not a \"object\"."}},d={cleaningList:function(e){return function(e){var r=e.list;return r&&p.array(r)?r.splice(0,r.length):u.warning="argument is not an array or undefined"}({list:e})},cleaningProperty:function(e,r){return p.array(r)?function(e){var r=e.object,t=e.properties;return r&&"object"===c(r)&&p.exist(r)?t.forEach(function(e){return delete r[e]}):u.warning="first argument is not an object or undefined"}({object:e,properties:r}):u.warning="second argument is not an array or undefined"}},y={};y=function(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n};var b={};b=function(e){if(Array.isArray(e))return y(e)};var g={};g=function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)};var m={};m=function(e,r){if(e){if("string"==typeof e)return y(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?y(e,r):void 0}};var w={};w=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")};var O={};O=function(e){return b(e)||g(e)||m(e)||w()};var j=function(r){return r.reduce(function(r,t){var n=e(O);return p.array(t)?[].concat(n.d(r),n.d(j(t))):[].concat(n.d(r),[t])},[])},v=function(e){return function(e){var r=e.payload;if(p.exist(r)||"object"===c(r))return Object.keys(r).forEach(function(e){return p.include(r[e],e)||!Object.isFrozen(r[e])?v(r[e]):r[e]}),Object.freeze(r);u.warning="parameter is not an \"object\" or \"undefined\""}({payload:e})};function x(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function h(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),t.push.apply(t,n)}return t}function S(r){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach(function(t){e(o).d(r,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(n,e))})}return r}var P=/[-._]/g,$={makeFirstLetterUpperCase:function(r){if(p.empty(r))return u.warning="\"string\" is empty.",r;var t=function(e){return!p.empty(e)},n=function(r,t){var n=e(O);return[].concat(n.d(r),[t.split("").map(function(e,r){return 0===r?e.toUpperCase():e}).join("")])};return function(e){return function(e){return e.trim().toLowerCase().replace(P," ").split(" ").filter(t)}(e).reduce(n,"").join("")}(r)},makeInteger:function(e,r){if(p.string(e))return e.replace(P,"").split(r).map(function(e){return p.string(e)?window.parseInt(e):e}).filter(function(e){return p.number(e)});u.warning="first argument is not a \"string\"."},toFirstLetterUpperCase:k,toFirstLetterUpperCaseReducer:function(e,r){if(u.warning="\"toFirstLetterUpperCaseReducer\" is deprecated used \"makeFirstLetterUpperCase\" instead.",!p.empty(e)){var t=e.split(P);return t.reduce(function(e,n,o){return e+=k(n),(null==r?void 0:r.length)>0&&o===t.length-1&&(e+=k(r)),e},"")}},ToInt:function(e,r){return u.warning="\"ToInt\" is deprecated used \"makeInteger\" instead.",e.split(r).map(function(e){return window.parseInt(e)})}};function k(r){return u.warning="\"toFirstLetterUpperCase\" is deprecated used \"makeFirstLetterUpperCase\" instead.",p.empty(r)?(u.warning="\"string\" is empty.",r):r.trim().toLowerCase().replace(P," ").split("").filter(function(e){return!p.empty(e)}).reduce(function(r,t,n){var o=e(O);return[].concat(o.d(r),[0===n?t.toUpperCase():t])},"").join("")}var A=window.navigator.userAgent,C={android:function(e){return /Android/.test(A)},browser:function(e){return /Chrome|Firefox|Safari/.test(A)},egde:function(e){return /Edge/.test(A)&&window.MSStream},ie:function(e){return /MSIE/.test(A)&&window.MSStream},ios:function(e){return /iPad|iPhone|iPod/.test(A)&&!window.MSStream},phone:function(e){return /iPhone|iPod|Android/.test(A)}},E={};function D(e){return E=D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D(e)}E=D;r.convert=l,r.debounce=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u.required,r=arguments.length>1?arguments[1]:void 0,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return function(n){window.clearTimeout(t),t=window.setTimeout(e(n),r)}},r.deletion=d,r.fail=u,r.flatten=j,r.frozen=v,r.is=p,r.loop=function(e,r){if(!p.empty(e))return p.array(e)&&p.contains(e)?function(e){var r=e.f;e.payload.forEach(function(e,t,n){return r({current:e,index:t,list:n})})}({payload:e,f:r}):u.warning="first argument is not an \"array\"."},r.merge=function(r,t){return p.trueObject(r)&&p.trueObject(t)?function(r){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach(function(t){e(o).d(r,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(n,e))})}return r}({},r,{},t):u.warning="argument are not valid."},r.oftype=c,r.pipe=function(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return function(e){return[].concat(r).reduce(function(e,r){return r(e)},e||{})}},r.ratio169=function(e){return p.number(e)?Math.round(e/16*9):u.warning="argument is not a \"number\"."},r.reducer=function(r,t){return Object.keys(S({},r)).reduce(function(n,i){return S({},n,e(o).d({},i,t(r[i])))},r)},r.strings=$,r.ua=C,r.uniqid=function(r){for(var t="xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",n=-1!==t.indexOf("x"),o=function(){var e,r=performance.now().toString().replace(/^.{4}/,"".concat(Math.random(),".")),n=parseFloat(r);return{v:(e=t,e.replace(/x/g,function(e){return(n*Math.random()*16|16*Math.random()).toString(16)}))}};n;){var i=o();if("object"===e(E).d(i))return i.v}},"object"==typeof B?B=r:"function"==typeof K&&K.amd?K(function(){return r}):this.u3s=r}();var ja=function(t){return function(t){return t.value=ma(),t}},ka=function(t){return t.identity=function(r){return _(t.value),t},t.inverse=function(r){return ra(t.value,r),t},t.lookAt=function(r,e,n){return ua(t.value,r,e,n),t},t.rotate=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.value,e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return da(t.value,r,e,n),t},t.scale=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.value,e=arguments.length>1?arguments[1]:void 0;return ea(t.value,r,"number"==typeof e?[e,e,e]:e),t},t.set=function(r,e,n,$,o,i,a,u,v,d,l,c,p,O,j,V){return Q(t.value,r,e,n,$,o,i,a,u,v,d,l,c,p,O,j,V),t},t.toOrthogonal=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=r.left,n=r.right,$=r.bottom,o=r.top,i=r.near,a=r.far;return Qa(t.value,e,n,$,o,i,a),t},t.toPerspective=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=r.fov,n=r.aspect,$=r.near,o=r.far;return ca(t.value,e,n,$,o),t},t.transpose=function(r){return Q(t.value,r),t},t.translate=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.value,e=arguments.length>1?arguments[1]:void 0;return ga(t.value,r,e),t},t},la=function(t){return t},z=function(){return B.pipe(ja(),ka,la)(this)};function na($,t,e,r){return $[0]=t,$[1]=e,$[2]=r,$}var oa=function(r){return function(t){return t.x=r.x,t.y=r.y,t.z=r.z,t}},pa=function(r){return r.set=function(t,e,$){return na(r.value,t,e,$),r},r},Ua=function(r){return r},H=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return B.pipe(oa({x:r,y:t,z:e}),pa,Ua)(this)};var sa=function(e){return function(e){return e.children=[],e.matrix=new z,e.worldMatrix=new z,e.position=new H,e.rotation=new H,e.scale=new H(1),e}},ta=function(e){return e},J=fa({},Object.assign({},F.extend(sa(),ta)));var va=function(){var r=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).name,e=void 0===r?"":r;return function(r){r.name=e,r.viewMatrix=new z,r.normals=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0],r.positions=[-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5],r.colors=[];var o=[[1,0,0,1],[1,1,0,1],[0,1,0,1],[1,.5,.5,1],[1,0,1,1],[0,0,1,1]];for(var t in o)for(var $=o[t],a=0;a<4;a++)r.colors=r.colors.concat($);return r.indices=[0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23],r}},wa=function(r){return r},xa=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.assign(this,J.extend(va(r),wa))};var ya=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=r.fov,e=void 0===t?45*Math.PI/180:t,a=r.aspect,o=void 0===a?window.innerWidth/window.innerHeight:a,p=r.near,i=void 0===p?.1:p,n=r.far,$=void 0===n?100:n,c=r.type,v=void 0===c?"":c;return function(r){return r.type=v,r.isCamera=!0,r.fov=e,r.aspect=o,r.near=i,r.far=$,r.projectionMatrix=new z,r.modelViewMatrix=new z,r.worldPosition=new H,r}},za=function(r){return r.perspective=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.fov,a=t.aspect,o=t.near,p=t.far;return r.projectionMatrix.toPerspective({fov:e,aspect:a,near:o,far:p}),Object.assign(r,{fov:e,aspect:a,near:o,far:p}),r},r.orthogonal=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.left,a=t.right,o=t.bottom,p=t.top,i=t.near,n=t.far;r.projectionMatrix.toOrthogonal({left:e,right:a,bottom:o,top:p,near:i,far:n}),Object.assign(r,{left:e,right:a,bottom:o,top:p,near:i,far:n})},r},Aa=function(r){return r},Ba=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.assign(this,J.extend(ya(r),za,Aa))};var Ca=function(r){return function(a){return a.color=r,a}},Da=function(r){return r.parse=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.color,o=Math.floor(a);return r.r=(o>>16&255)/255,r.g=(o>>8&255)/255,r.b=(255&o)/255,r},r},Ea=function(r){return r.parse(r.color),r},Fa=function(r){return B.pipe(Ca({x:x,y:y,z:z}),Da,Ea)(this)};var Ga=function(){var r=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).name,e=void 0===r?"":r;return function(r){return r.name=e,r.viewMatrix=new z,r.indices=[0,1,2,1,2,3],r.positions=[-1,1,0,1,1,0,-1,-1,0,1,-1,0],r.colors=[1,0,0,1,0,1,0,1,0,0,1,1,1,1,0,1],r}},Ha=function(r){return r},Ia=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.assign(this,J.extend(Ga(r),Ha))};var Ja="\n  // # \u03BB <\u2022 /* TODO: including */ \u2022>\n  \n  attribute vec4 position;\n  attribute vec4 color;\n  attribute vec2 texture2d;\n\n  uniform mat4 modelViewMatrix;\n  uniform mat4 projectionMatrix;\n  uniform vec2 sampler2d;\n\n  varying vec4 vColor;\n  varying vec2 vTexture;\n\n  void main(void) {\n    gl_Position = projectionMatrix * modelViewMatrix * position;\n    vColor = color;\n    vTexture = texture2d;\n  }\n",Ka="\n  #ifdef GL_ES\n  precision highp float;\n  #endif\n\n  varying vec4 vColor;\n\n  void main(void) {\n\n    gl_FragColor = vColor;\n  }\n",La=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=r.alpha,t=void 0!==e&&e,a=r.antialias,o=void 0===a||a,i=r.autoClear,n=void 0===i||i,l=r.canvas,g=void 0===l?document.createElement("canvas"):l,c=r.width,d=void 0===c?200:c,p=r.height,f=void 0===p?200:p,u=r.dpr,m=void 0===u?window.devicePixelRatio:u;return function(r){return r.canvas=g,r.autoClear=n,r.gl=g.getContext("webgl",{alpha:t,antialias:o}),r.program=null,r.width=d,r.height=f,r.modelViewMatrix=new z,r.dpr=m,r}},Ma=0,Na=function(r){return r.onrender=function(e){var t,a=e.scene,o=e.camera;r.gl.clear(r.gl.COLOR_BUFFER_BIT|r.gl.DEPTH_BUFFER_BIT);for(var i=0;i<a.children.length;i++)(t=a.children[i])&&(t.__positionBuffer||(t.__positionBuffer=r.gl.createBuffer()),r.gl.bindBuffer(r.gl.ARRAY_BUFFER,t.__positionBuffer),r.gl.bufferData(r.gl.ARRAY_BUFFER,new Float32Array(t.positions),r.gl.STATIC_DRAW),t.__colorBuffer||(t.__colorBuffer=r.gl.createBuffer()),r.gl.bindBuffer(r.gl.ARRAY_BUFFER,t.__colorBuffer),r.gl.bufferData(r.gl.ARRAY_BUFFER,new Float32Array(t.colors),r.gl.STATIC_DRAW),t.__indexBuffer||(t.__indexBuffer=r.gl.createBuffer()),r.gl.bindBuffer(r.gl.ELEMENT_ARRAY_BUFFER,t.__indexBuffer),r.gl.bufferData(r.gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(t.indices),r.gl.STATIC_DRAW),r.setupMatrices({object3d:null,camera:o}),r.gl.bindBuffer(r.gl.ARRAY_BUFFER,t.__positionBuffer),r.gl.vertexAttribPointer(r.program.position,3,r.gl.FLOAT,!1,0,0),r.gl.enableVertexAttribArray(r.program.position),r.gl.bindBuffer(r.gl.ARRAY_BUFFER,t.__colorBuffer),r.gl.vertexAttribPointer(r.program.color,4,r.gl.FLOAT,!1,0,0),r.gl.enableVertexAttribArray(r.program.color),r.gl.bindBuffer(r.gl.ELEMENT_ARRAY_BUFFER,t.__indexBuffer),r.gl.uniformMatrix4fv(r.program.projectionMatrix,!1,o.projectionMatrix.value),r.gl.uniformMatrix4fv(r.program.modelViewMatrix,!1,o.modelViewMatrix.value));return r.gl.drawElements(r.gl.TRIANGLES,t.indices.length,r.gl.UNSIGNED_SHORT,0),Ma+=Math.PI/180,r},r.initGL=function(e){return r.gl.clearColor(0,0,0,1),r.gl.clearDepth(1),r.gl.enable(r.gl.DEPTH_TEST),r.gl.depthFunc(r.gl.LEQUAL),r.gl.clear(r.gl.COLOR_BUFFER_BIT|r.gl.DEPTH_BUFFER_BIT),r},r.initProgram=function(e){return r.program=r.gl.createProgram(),r.gl.attachShader(r.program,ba({gl:r.gl,type:"fragment",codeSource:Ka})),r.gl.attachShader(r.program,ba({gl:r.gl,type:"vertex",codeSource:Ja})),r.gl.linkProgram(r.program),r.gl.getProgramParameter(r.program,r.gl.LINK_STATUS)||(B.fail.warning="Could not initialise shaders, ".concat(gl.getProgramInfoLog(r.program))),r.gl.useProgram(r.program),r.program.modelViewMatrix=r.gl.getUniformLocation(r.program,"modelViewMatrix"),r.program.projectionMatrix=r.gl.getUniformLocation(r.program,"projectionMatrix"),r.program.normalMatrix=r.gl.getUniformLocation(r.program,"normalMatrix"),r.program.position=r.gl.getAttribLocation(r.program,"position"),r.gl.enableVertexAttribArray(r.program.position),r.program.color=r.gl.getAttribLocation(r.program,"color"),r.gl.enableVertexAttribArray(r.program.color),r.program.viewMatrixArray=new Float32Array(16),r.program.modelViewMatrixArray=new Float32Array(16),r.program.projectionMatrixArray=new Float32Array(16),r},r.resize=function(e){return r.setSize(),r.gl.viewport(0,0,r.canvas.width,r.canvas.height),r},r.setSize=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.width,a=void 0===t?window.innerWidth:t,o=e.height,i=void 0===o?window.innerHeight:o;return r.canvas.width=a*r.dpr,r.canvas.height=i*r.dpr,Object.assign(r.canvas.style,{width:"".concat(a,"px"),height:"".concat(i,"px")}),r},r.setupMatrices=function(e){var t=e.camera;switch(t.type){case"perspective":t.perspective({fov:t.fov,aspect:t.aspect,near:t.near,far:t.far});break;case"orthogonal":t.orthogonal({left:t.left,right:t.right,bottom:t.bottom,top:t.top,near:t.near,far:t.far});break;default:return;}return t.modelViewMatrix.identity(),t.modelViewMatrix.translate(t.modelViewMatrix.value,[t.position.x,t.position.y,t.position.z]),t.modelViewMatrix.rotate(t.modelViewMatrix.value,Ma,[t.rotation.x,t.rotation.y,t.rotation.z]),r},r},Oa=function(r){return r.initProgram().initGL().resize(),r},Pa=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object.assign(this,F.extend(La(r),Na,Oa))};function ba(r){var e=r.gl,t=r.type,a=r.codeSource,o={fragment:e.createShader(e.FRAGMENT_SHADER),vertex:e.createShader(e.VERTEX_SHADER)}[t];return e.shaderSource(o,a),e.compileShader(o),e.getShaderParameter(o,e.COMPILE_STATUS)?o:(console.log(e.getShaderInfoLog(o)),null)}var Ra=function(e){return function(e){return e.uuid=B.uniqid(),e.name="",e.type="scene",e.isScene=!0,e.children=[],e}},Sa=function(e){return e.add=function(r){return e.children.push(r),e},e},Ta=function(e){return e},qa=function(){Object.assign(this,F.extend(Ra(),Sa,Ta))};q.Archetype=F,q.Box=xa,q.Camera=Ba,q.Color=Fa,q.Plane=Ia,q.Renderer=Pa,q.Renderable=J,q.Scene=qa;if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=q}else if(typeof define==="function"&&define.amd){define(function(){return q})}else{this["d2k"]=q}})();